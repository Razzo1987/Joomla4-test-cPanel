Joomla=window.Joomla||{},Joomla.MediaManager=Joomla.MediaManager||{},function(){'use strict';var a=Joomla.getOptions("com_media",{});if(!a)throw new Error("Initialization error \"edit-images.js\"");Joomla.MediaManager.Edit.original={filename:a.uploadPath.split("/").pop(),extension:a.uploadPath.split(".").pop(),contents:"data:image/".concat(a.uploadPath.split(".").pop(),";base64,").concat(a.contents)},Joomla.MediaManager.Edit.history={},Joomla.MediaManager.Edit.current={};var b=function(a,b){if(b.contents){var c=document.getElementById("media-manager-edit-container"),d=document.createElement("div"),e=document.createElement("div"),f=document.createElement("img"),g=document.createElement("img");c.innerHTML="",f.src=b.contents,f.id="image-source",f.style.maxWidth="100%",g.src=b.contents,g.id="image-preview",g.style.maxWidth="100%",d.classList.add("hidden"),d.appendChild(f),c.appendChild(d),e.appendChild(g),c.appendChild(e),Joomla.MediaManager.Edit[a.toLowerCase()].Activate(b)}};Joomla.MediaManager.Edit.Reset=function(a){(!a||a&&"initial"===a)&&(Joomla.MediaManager.Edit.current.contents=Joomla.MediaManager.Edit.original.contents);var c=document.getElementById("media-manager-edit-container");c.innerHTML="";var d=document.getElementById("myTab").firstElementChild;if("UL"===d.tagName){var e=[].slice.call(d.querySelectorAll("a"));e.forEach(function(c){if(c.hasAttribute("active")){Joomla.MediaManager.Edit[c.id.replace("tab-attrib-","").toLowerCase()].Deactivate();var d=Joomla.MediaManager.Edit.current;(!a||a&&!0!==a)&&(d=Joomla.MediaManager.Edit.original),c.click();var e=document.getElementById("media-manager-edit-container"),f=document.getElementById(c.id.replace("tab-",""));f.insertAdjacentElement("afterbegin",e),b(c.id.replace("tab-attrib-",""),d)}})}},window.addEventListener("mediaManager.history.point",function(){if(Joomla.MediaManager.Edit.original!==Joomla.MediaManager.Edit.current.contents){var a=Object.keys(Joomla.MediaManager.Edit.history).length;if(Joomla.MediaManager.Edit.history[a]&&Joomla.MediaManager.Edit.history[a-1]&&Joomla.MediaManager.Edit.history[a]===Joomla.MediaManager.Edit.history[a-1])return;Joomla.MediaManager.Edit.history[a+1]=Joomla.MediaManager.Edit.current.contents}}),Joomla.MediaManager.Edit.Undo=function(){},Joomla.MediaManager.Edit.Redo=function(){},Joomla.MediaManager.Edit.createProgressBar=function(){},Joomla.MediaManager.Edit.updateProgressBar=function(){},Joomla.MediaManager.Edit.removeProgressBar=function(){},Joomla.submitbutton=function(b){var c="jpg"===Joomla.MediaManager.Edit.original.extension?"jpeg":Joomla.MediaManager.Edit.original.extension,d=window.location.pathname.replace(/&view=file.*/g,""),e=a.uploadPath.split("/").pop(),f={name:e,content:Joomla.MediaManager.Edit.current.contents.replace("data:image/".concat(c,";base64,"),"")},g=a.uploadPath,h="".concat(a.apiBaseUrl,"&task=api.files&path=").concat(g),i="application/json";f[a.csrfToken]="1";var j=g.split("/");switch(j.pop(),j=j.join("/"),j.endsWith(":")&&(j="".concat(j,"/")),b){case"apply":Joomla.UploadFile.exec(e,JSON.stringify(f),g,h,i),Joomla.MediaManager.Edit.Reset(!0);break;case"save":Joomla.UploadFile.exec(e,JSON.stringify(f),g,h,i),window.location="".concat(d,"?option=com_media&path=").concat(j);break;case"cancel":window.location=window.self===window.top?"".concat(d,"?option=com_media&path=").concat(j):"".concat(d,"?option=com_media&path=").concat(j,"&tmpl=component");break;case"reset":Joomla.MediaManager.Edit.Reset("initial");break;case"undo":break;case"redo":break;default:}},Joomla.UploadFile={},Joomla.UploadFile.exec=function(a,b,c,d,e){var f=new XMLHttpRequest;f.upload.onprogress=function(a){Joomla.MediaManager.Edit.updateProgressBar(100*(a.loaded/a.total))},f.onload=function(){var a;try{a=JSON.parse(f.responseText)}catch(b){a=null}a?200===f.status&&(!0===a.success&&Joomla.MediaManager.Edit.removeProgressBar(),"1"===a.status&&(Joomla.renderMessages({success:[a.message]},"true"),Joomla.MediaManager.Edit.removeProgressBar())):Joomla.MediaManager.Edit.removeProgressBar()},f.onerror=function(){Joomla.MediaManager.Edit.removeProgressBar()},f.open("PUT",d,!0),f.setRequestHeader("Content-Type",e),Joomla.MediaManager.Edit.createProgressBar(),f.send(b)},document.addEventListener("DOMContentLoaded",function(){var a=function(){var c=document.getElementById("myTab").firstElementChild;if("UL"!==c.tagName)return void setTimeout(a,50);var d=[].slice.call(c.querySelectorAll("a"));d[0]&&b(d[0].id.replace("tab-attrib-",""),Joomla.MediaManager.Edit.original),d.forEach(function(a){a.addEventListener("joomla.tab.shown",function(a){var c=a.relatedTarget,d=a.target,e=document.getElementById("media-manager-edit-container");c&&(Joomla.MediaManager.Edit[c.id.replace("tab-attrib-","").toLowerCase()].Deactivate(),e.innerHTML="");var f=Joomla.MediaManager.Edit.current;"contents"in Joomla.MediaManager.Edit.current||(f=Joomla.MediaManager.Edit.original);var g=document.getElementById(d.id.replace("tab-",""));g.insertAdjacentElement("afterbegin",e),b(d.id.replace("tab-attrib-",""),f)}),a.click()}),d[0]&&(d[0].click(),b(d[0].id.replace("tab-attrib-",""),Joomla.MediaManager.Edit.original))};setTimeout(a,50)})}();