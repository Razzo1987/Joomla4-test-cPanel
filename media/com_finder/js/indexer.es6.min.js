((a,b)=>{'use strict';if(!a)throw new Error("core.js was not properly initialised");a.finderIndexer=()=>{let c,d=null,e=null,f=null,g=!1;const h=`&${b.getElementById("finder-indexer-token").getAttribute("name")}=1`,i=a=>{const c=b.getElementById(a);return c?c.parentNode.removeChild(c):null},j=(c,g)=>{f=100*(e/d);const h=b.getElementById("progress-bar"),j=b.getElementById("finder-progress-header"),k=b.getElementById("finder-progress-message");j&&(j.innerText=c),k&&(k.innerHTML=g),h&&(100>f?(h.style.width=`${f}%`,h.setAttribute("aria-valuenow",f)):(h.classList.remove("bar-success"),h.classList.add("bar-warning"),h.setAttribute("aria-valuemin",100),h.setAttribute("aria-valuemax",200),h.style.width=`${f}%`,h.setAttribute("aria-valuenow",f)),g===a.Text._("COM_FINDER_INDEXER_MESSAGE_COMPLETE")&&(i("progress"),window.parent.Joomla.Modal.getCurrent().close()))},k=(f,h)=>{const k=b.getElementById("finder-progress-header"),l=b.getElementById("finder-progress-message");try{if(null===f)throw new Error(h);if(f.error)throw new Error(f);if(f.start&&(d=f.totalItems,b.getElementById("finder-debug-data"))){const a=b.getElementById("finder-debug-data");Object.entries(f.pluginState).forEach(b=>{let c=`<dt class="col-sm-3">${b[0]}</dt>`;c+=`<dd id="finder-${b[0].replace(/\s+/g,"-").toLowerCase()}" class="col-sm-9"></dd>`,a.insertAdjacentHTML("beforeend",c)})}e+=f.batchOffset,j(f.header,f.message),b.getElementById("finder-debug-data")&&Object.entries(f.pluginState).forEach(a=>{b.getElementById(`finder-${a[0].replace(/\s+/g,"-").toLowerCase()}`).innerHTML=`${f.pluginState[a[0]].offset} of ${f.pluginState[a[0]].total}`}),e<d?c("indexer.batch"):!g&&(g=!0,c("indexer.optimize"))}catch(b){i("progress");try{f.error&&(k&&(k.innerText=f.header,k.classList.add("finder-error")),l&&(l.innerHTML=f.message,l.classList.add("finder-error")))}catch(c){""===b&&(b=a.JText._("COM_FINDER_NO_ERROR_RETURNED")),k&&(k.innerText=a.JText._("COM_FINDER_AN_ERROR_HAS_OCCURRED"),k.classList.add("finder-error")),l&&(l.innerHTML=b,l.classList.add("finder-error"))}}return!0},l=c=>{const d=b.getElementById("finder-progress-header"),e=b.getElementById("finder-progress-message");let f="object"==typeof c&&c.responseText?c.responseText:null;f=f?JSON.parse(f):null,i("progress"),f&&(f=null===f.responseText?f:f.evaluate(f.responseText,!0));const g=f?f.header:a.JText._("COM_FINDER_AN_ERROR_HAS_OCCURRED"),h=f?f.message:`${a.JText._("COM_FINDER_MESSAGE_RETURNED")}<br>${f}`;d&&(d.innerText=g,d.classList.add("finder-error")),e&&(e.innerHTML=h,e.classList.add("finder-error"))};c=b=>{a.request({url:`${"index.php?option=com_finder&tmpl=component&format=json"}&task=${b}${h}`,method:"GET",data:"",perform:!0,headers:{"Content-Type":"application/x-www-form-urlencoded"},onSuccess:a=>{k(JSON.parse(a))},onError:a=>{l(a)}})};const m=()=>{e=0,f=0,c("indexer.start")};m()}})(Joomla,document),document.addEventListener("DOMContentLoaded",()=>{window.Indexer=Joomla.finderIndexer()});