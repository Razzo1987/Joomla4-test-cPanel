tinymce.PluginManager.add("jdragndrop",a=>{function b(b,c){const d=`${tinyMCE.activeEditor.settings.uploadUri}&path=${tinyMCE.activeEditor.settings.comMediaAdapter}`,e={[tinyMCE.activeEditor.settings.csrfToken]:"1",name:b,content:c,parent:tinyMCE.activeEditor.settings.parentUploadFolder};Joomla.request({url:d,method:"POST",data:JSON.stringify(e),headers:{"Content-Type":"application/json"},onSuccess:b=>{let c;try{c=JSON.parse(b)}catch(b){a.windowManager.alert(`${Joomla.Text._("JERROR")}: {e}`)}if(c.data&&c.data.path){let a;if(/local-/.test(c.data.adapter)){const{rootFull:b}=Joomla.getOptions("system.paths");a=`${c.data.thumb_path.split(b)[1]}`}else c.data.thumb_path&&(a=c.data.thumb_path);tinyMCE.activeEditor.execCommand("mceInsertContent",!1,`<img loading="lazy" src="${a}" alt=""/>`)}},onError:b=>{a.windowManager.alert(`Error: ${b.statusText}`)}})}function c(a){const c=new FileReader;c.onload=c=>{const{result:d}=c.target,e=d.indexOf("base64")+7,f=d.slice(e,d.length);b(a.name,f)},c.readAsDataURL(a)}tinyMCE.DOM.bind(document,"dragleave",a=>(a.stopPropagation(),a.preventDefault(),tinyMCE.activeEditor.contentAreaContainer.style.borderWidth="1px 0 0",!1)),a.on("dragenter",a=>(a.stopPropagation(),!1)),a.on("dragover",b=>(b.preventDefault(),a.contentAreaContainer.style.borderStyle="dashed",a.contentAreaContainer.style.borderWidth="5px",!1)),"undefined"==typeof FormData?(Joomla.renderMessages({error:[Joomla.JText._("PLG_TINY_ERR_UNSUPPORTEDBROWSER")]}),a.on("drop",a=>(a.preventDefault(),!1))):a.on("drop",b=>{if(b.preventDefault(),b.dataTransfer&&b.dataTransfer.files&&0<b.dataTransfer.files.length){const a=[].slice.call(b.dataTransfer.files);a.forEach(a=>{a.name.toLowerCase().match(/\.(jpg|jpeg|png|gif)$/)&&c(a)})}a.contentAreaContainer.style.borderWidth="1px 0 0"})});