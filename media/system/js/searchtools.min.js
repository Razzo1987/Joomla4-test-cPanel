function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}Joomla=window.Joomla||{},function(a){'use strict';a.resetFilters=function(a){var b=a.form;if(!b)throw new Error("Element must be inside a form!");var c=[].slice.call(b.elements);if(c.length){var d=[];c.forEach(function(b){"task"===b.getAttribute("name")||"boxchecked"===b.getAttribute("name")||"1"===b.value&&/^[0-9A-F]{32}$/i.test(b.name)||b===a||d.push(b)}),d.forEach(function(a){a.value=""}),b.submit()}};var b=function(){function b(c,d){_classCallCheck(this,b);this.element=c,this.options=a.extend({formSelector:".js-stools-form",searchFieldSelector:".js-stools-field-search",clearBtnSelector:".js-stools-btn-clear",mainContainerSelector:".js-stools",searchBtnSelector:".js-stools-btn-search",filterBtnSelector:".js-stools-btn-filter",filterContainerSelector:".js-stools-container-filters",filtersHidden:!0,listBtnSelector:".js-stools-btn-list",listContainerSelector:".js-stools-container-list",listHidden:!0,orderColumnSelector:".js-stools-column-order",orderBtnSelector:".js-stools-btn-order",orderFieldSelector:".js-stools-field-order",orderFieldName:"list[fullordering]",limitFieldSelector:".js-stools-field-limit",defaultLimit:20,activeOrder:null,activeDirection:"ASC",clearListOptions:!1},d),this.theForm=document.querySelector(this.options.formSelector),this.filterButton=document.querySelector("".concat(this.options.formSelector," ").concat(this.options.filterBtnSelector)),this.filterContainer=document.querySelector("".concat(this.options.formSelector," ").concat(this.options.filterContainerSelector))?document.querySelector("".concat(this.options.formSelector," ").concat(this.options.filterContainerSelector)):"",this.filtersHidden=this.options.filtersHidden,this.listButton=document.querySelector(this.options.listBtnSelector),this.listContainer=document.querySelector("".concat(this.options.formSelector," ").concat(this.options.listContainerSelector)),this.listHidden=this.options.listHidden,this.mainContainer=document.querySelector(this.options.mainContainerSelector),this.searchButton=document.querySelector("".concat(this.options.formSelector," ").concat(this.options.searchBtnSelector)),this.searchField=document.querySelector("".concat(this.options.formSelector," ").concat(this.options.searchFieldSelector)),this.searchString=null,this.clearButton=document.querySelector(this.options.clearBtnSelector),this.orderCols=Array.prototype.slice.call(document.querySelectorAll("".concat(this.options.formSelector," ").concat(this.options.orderColumnSelector))),this.orderField=document.querySelector("".concat(this.options.formSelector," ").concat(this.options.orderFieldSelector)),this.limitField=document.querySelector("".concat(this.options.formSelector," ").concat(this.options.limitFieldSelector)),this.activeColumn=null,this.activeDirection=this.options.activeDirection,this.activeOrder=this.options.activeOrder,this.activeLimit=null,this.clearListOptions=this.options.clearListOptions;var f=this;this.searchString=this.searchField.value,this.showFilters=this.showFilters.bind(this),this.hideFilters=this.hideFilters.bind(this),this.showList=this.showList.bind(this),this.hideList=this.hideList.bind(this),this.toggleFilters=this.toggleFilters.bind(this),this.toggleList=this.toggleList.bind(this),this.checkFilter=this.checkFilter.bind(this),this.clear=this.clear.bind(this),this.createOrderField=this.createOrderField.bind(this),this.checkActiveStatus=this.checkActiveStatus.bind(this),this.activeFilter=this.activeFilter.bind(this),this.deactiveFilter=this.deactiveFilter.bind(this),this.getFilterFields=this.getFilterFields.bind(this),this.getListFields=this.getListFields.bind(this),this.hideContainer=this.hideContainer.bind(this),this.showContainer=this.showContainer.bind(this),this.toggleContainer=this.toggleContainer.bind(this),this.toggleDirection=this.toggleDirection.bind(this),this.updateFieldValue=this.updateFieldValue.bind(this),this.findOption=this.findOption.bind(this),this.filterContainer&&this.filterContainer.classList.contains("js-stools-container-filters-visible")?(this.showFilters(),this.showList()):(this.hideFilters(),this.hideList()),this.filterButton&&this.filterButton.addEventListener("click",function(a){f.toggleFilters(),a.stopPropagation(),a.preventDefault()}),this.listButton&&this.listButton.addEventListener("click",function(a){f.toggleList(),a.stopPropagation(),a.preventDefault()}),this.getFilterFields()&&this.getFilterFields().forEach(function(a){f.checkFilter(a),a.addEventListener("change",function(){f.checkFilter(a)})}),this.clearButton&&this.clearButton.addEventListener("click",f.clear),this.createOrderField(),this.orderCols.forEach(function(a){a.addEventListener("click",function(a){var b=a.target,c="span"===b.tagName.toLowerCase()?b.parentNode:b,d=c.getAttribute("data-order"),e=c.getAttribute("data-direction"),g="".concat(d," ").concat(e);d.length&&(f.activeColumn=d,g===f.activeOrder?f.toggleDirection():(f.activeDirection=e,f.activeOrder=g,f.updateFieldValue(f.orderField,g)),f.theForm.submit())})}),this.checkActiveStatus(this)}return _createClass(b,[{key:"checkFilter",value:function checkFilter(a){var b=a.querySelector("option:checked");b&&(""===b.value?this.deactiveFilter(a,this):this.activeFilter(a,this))}},{key:"clear",value:function clear(){var a=this;a.searchField&&(a.searchField.value=""),a.getFilterFields()&&a.getFilterFields().forEach(function(b){b.value="",a.checkFilter(b),window.jQuery&&window.jQuery.chosen&&window.jQuery(b).trigger("chosen:updated")}),a.clearListOptions&&(a.getListFields().forEach(function(b){b.value="",a.checkFilter(b),window.jQuery&&window.jQuery.chosen&&window.jQuery(b).trigger("chosen:updated")}),document.querySelector("#list_limit").value=a.options.defaultLimit,window.jQuery&&window.jQuery.chosen&&window.jQuery("#list_limit").trigger("chosen:updated")),a.theForm.submit()}},{key:"updateFilterCount",value:function updateFilterCount(a){this.clearButton&&(this.clearButton.disabled=0===a&&!this.searchString.length)}},{key:"checkActiveStatus",value:function checkActiveStatus(a){var b=a.mainContainer,c=[].slice.call(b.querySelectorAll(".js-stools-field-filter select")),d=0;if(c.forEach(function(b){b.classList.contains("active")&&(d+=1,a.filterButton.classList.remove("btn-secondary"),a.filterButton.classList.add("btn-primary"))}),0===d){var e=document.getElementById("filteredBy");e&&e.parentNode.removeChild(e)}this.clearButton&&(this.clearButton.disabled=0===d&&!this.searchString.length)}},{key:"activeFilter",value:function activeFilter(a){a.classList.add("active");var b="#".concat(a.getAttribute("id")),c=a.querySelector(b);c&&c.classList.add("active");var d=document.getElementById("filteredBy");if(d){var g="";if(!0===a.multiple){var e=a.querySelectorAll("option:checked"),f=[].slice.call(e).map(function(a){return a.text});g="".concat(a.labels[0].textContent," - ").concat(f.join())}else g="".concat(a.labels[0].textContent," - ").concat(a.options[a.selectedIndex].text);d.textContent+=g}}},{key:"deactiveFilter",value:function deactiveFilter(a){a.classList.remove("active");var b="#".concat(a.getAttribute("id")),c=a.querySelector(b);c&&c.classList.remove("active")}},{key:"getFilterFields",value:function getFilterFields(){if(this.filterContainer)return Array.prototype.slice.call(this.filterContainer.querySelectorAll("select,input"))}},{key:"getListFields",value:function getListFields(){return Array.prototype.slice.call(this.listContainer.querySelectorAll("select"))}},{key:"hideContainer",value:function hideContainer(a){a&&(a.classList.remove("js-stools-container-filters-visible"),document.body.classList.remove("filters-shown"))}},{key:"showContainer",value:function showContainer(a){a.classList.add("js-stools-container-filters-visible"),document.body.classList.add("filters-shown")}},{key:"toggleContainer",value:function toggleContainer(a){a.classList.contains("js-stools-container-filters-visible")?this.hideContainer(a):this.showContainer(a)}},{key:"hideList",value:function hideList(){this.hideContainer(this.filterContainer)}},{key:"showList",value:function showList(){this.showContainer(this.filterContainer)}},{key:"toggleList",value:function toggleList(){this.toggleContainer(this.filterContainer)}},{key:"hideFilters",value:function hideFilters(){this.hideContainer(this.filterContainer)}},{key:"showFilters",value:function showFilters(){this.showContainer(this.filterContainer)}},{key:"toggleFilters",value:function toggleFilters(){this.toggleContainer(this.filterContainer)}},{key:"toggleDirection",value:function toggleDirection(){var a=this,b="ASC";"ASC"===a.activeDirection.toUpperCase()&&(b="DESC"),a.activeDirection=b,a.activeOrder="".concat(a.activeColumn," ").concat(b),a.updateFieldValue(a.orderField,a.activeOrder)}},{key:"createOrderField",value:function createOrderField(){var a=this,b=this;if(this.orderField||(this.orderField=document.createElement("input"),this.orderField.setAttribute("type","hidden"),this.orderField.setAttribute("id","js-stools-field-order"),this.orderField.setAttribute("class","js-stools-field-order"),this.orderField.setAttribute("name",b.options.orderFieldName),this.orderField.setAttribute("value","".concat(b.activeOrder," ").concat(this.activeDirection)),this.theForm.innerHTML+=this.orderField.outerHTML),"select"===this.orderField.tagName.toLowerCase()){var c=[].slice.call(this.orderField.options);c.forEach(function(c){var d=c.getAttribute("data-order"),e=c.getAttribute("data-name"),f=c.getAttribute("data-direction");if(d&&d.length){d="".concat(d," ").concat(f);var g=b.findOption(b.orderField,d);g.length||(g=document.createElement("option"),g.text=e,g.value=d,c.classList.contains("active")&&g.setAttribute("selected","selected"),a.orderFieldName.innerHTML+=g)}}),window.jQuery&&window.jQuery.chosen&&window.jQuery(this.orderField).trigger("chosen:updated")}this.activeOrder=this.orderField.value}},{key:"updateFieldValue",value:function updateFieldValue(a,b){var c=a.getAttribute("type");if("hidden"===c||"text"===c)a.setAttribute("value",b);else if("select"===a.tagName.toLowerCase()){var d,e=[].slice.call(a.options);if(e.forEach(function(a){a.value===b&&(d=a)}),d&&d.length)d.setAttribute("selected","selected");else{var f=document.createElement("option");f.text=b,f.value=b,f.setAttribute("selected","selected"),a.appendChild(f)}a.value=b,window.jQuery&&window.jQuery.chosen&&a.trigger("chosen:updated")}}},{key:"findOption",value:function findOption(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c].value===b)return a[c]}}]),b}(),c=function(){if(a.getOptions("searchtools")){var d=a.getOptions("searchtools"),e=document.querySelector(d.selector);new b(e,d)}var f=document.getElementById("sorted");if(f&&f.hasAttribute("data-caption")){var g=f.getAttribute("data-caption");document.getElementById("orderedBy").textContent+=g}if(f&&f.hasAttribute("data-sort")){var h=f.getAttribute("data-sort");f.parentNode.setAttribute("aria-sort",h)}document.removeEventListener("DOMContentLoaded",c)};document.addEventListener("DOMContentLoaded",c)}(Joomla);