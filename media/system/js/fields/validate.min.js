function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}(function(a){'use strict';var b=function(){function b(){var c=this;_classCallCheck(this,b),this.customValidators={},this.handlers=[],this.handlers={},this.removeMarking=this.removeMarking.bind(this),this.inputEmail=function(){var b=a.createElement("input");return b.setAttribute("type","email"),"text"!==b.type},this.setHandler("username",function(a){return!/[<|>|"|'|%|;|(|)|&]/i.test(a)}),this.setHandler("password",function(a){return /^\S[\S ]{2,98}\S$/.test(a)}),this.setHandler("numeric",function(a){return /^(\d|-)?(\d|,)*\.?\d*$/.test(a)}),this.setHandler("email",function(a){var b=window.punycode.toASCII(a);return /^[a-zA-Z0-9.!#$%&â€™*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(b)});var d=[].slice.call(a.querySelectorAll("form"));d.forEach(function(a){a.classList.contains("form-validate")&&c.attachToForm(a)})}return _createClass(b,[{key:"setHandler",value:function setHandler(a,b,c){this.handlers[a]={enabled:""===c||c,exec:b}}},{key:"markValid",value:function markValid(a){var b,c=a.form.querySelector("label[for=\"".concat(a.id,"\"]"));(a.classList.contains("required")||a.getAttribute("required"))&&c&&(b=c.querySelector("span.form-control-feedback")),a.classList.remove("form-control-danger"),a.classList.remove("invalid"),a.classList.add("form-control-success"),a.parentNode.classList.remove("has-danger"),a.parentNode.classList.add("has-success"),a.setAttribute("aria-invalid","false"),b&&b.parentNode.removeChild(b),c&&c.classList.remove("invalid")}},{key:"markInvalid",value:function markInvalid(b,c){var d=b.form.querySelector("label[for=\"".concat(b.id,"\"]"));b.classList.remove("form-control-success"),b.classList.remove("valid"),b.classList.add("form-control-danger"),b.classList.add("invalid"),b.parentNode.classList.remove("has-success"),b.parentNode.classList.add("has-danger"),b.setAttribute("aria-invalid","true");var e,f=b.getAttribute("data-validation-text");if(d&&(e=d.querySelector("span.form-control-feedback")),!e){var g=a.createElement("span");g.classList.add("form-control-feedback"),g.innerHTML=c&&"checkbox"===c?f||Joomla.JText._("JLIB_FORM_FIELD_REQUIRED_CHECK"):c&&"value"===c?f||Joomla.JText._("JLIB_FORM_FIELD_REQUIRED_VALUE"):f||Joomla.JText._("JLIB_FORM_FIELD_INVALID_VALUE"),d&&d.appendChild(g)}d&&d.classList.add("invalid")}},{key:"removeMarking",value:function removeMarking(a){var b,c=a.form.querySelector("label[for=\"".concat(a.id,"\"]"));c&&(b=c.querySelector("span.form-control-feedback")),a.classList.remove("form-control-danger"),a.classList.remove("form-control-success"),a.classList.remove("invalid"),a.classList.add("valid"),a.parentNode.classList.remove("has-danger"),a.parentNode.classList.remove("has-success"),b&&c&&c.removeChild(b),c&&c.classList.remove("invalid")}},{key:"handleResponse",value:function handleResponse(a,b,c){"button"!==b.tagName.toLowerCase()&&void 0!==b.value&&(!1===a?this.markInvalid(b,c):this.markValid(b))}},{key:"validate",value:function validate(a){var b;if("disabled"===a.getAttribute("disabled")||"none"===a.getAttribute("display"))return this.handleResponse(!0,a),!0;if(a.getAttribute("required")||a.classList.contains("required"))if(b=a.tagName.toLowerCase(),!("fieldset"===b&&(a.classList.contains("radio")||a.classList.contains("checkboxes")))){if("checkbox"===a.getAttribute("type")&&!0!==a.checked||"select"===b&&!a.value.length)return this.handleResponse(!1,a,"checkbox"),!1;if(!a.value||a.classList.contains("placeholder"))return this.handleResponse(!1,a,"value"),!1}else if(!a.querySelector("input:checked").length)return this.handleResponse(!1,a,"checkbox"),!1;var c=a.getAttribute("class")&&a.getAttribute("class").match(/validate-([a-zA-Z0-9_-]+)/)?a.getAttribute("class").match(/validate-([a-zA-Z0-9_-]+)/)[1]:"";if(a.getAttribute("pattern")&&""!==a.getAttribute("pattern")){if(a.value.length){var d=new RegExp("^".concat(a.getAttribute("pattern"),"$")).test(a.value);return this.handleResponse(d,a,"empty"),d}return a.hasAttribute("required")||a.classList.contains("required")?(this.handleResponse(!1,a,"empty"),!1):(this.handleResponse(!0,a),!1)}return""===c?(this.handleResponse(!0,a),!0):c&&"none"!==c&&this.handlers[c]&&a.value&&!0!==this.handlers[c].exec(a.value,a)?(this.handleResponse(!1,a,"invalid_value"),!1):(this.handleResponse(!0,a),!0)}},{key:"isValid",value:function isValid(a){var b,c,d=this,e=!0,f=[],g=[].slice.call(a.querySelectorAll("input, textarea, select, button"));return g.forEach(function(a){!1===d.validate(a)&&(e=!1,f.push(a))}),Object.keys(this.customValidators).length&&Object.keys(this.customValidators).foreach(function(a){!0!==d.customValidators[a].exec()&&(e=!1)}),!e&&0<f.length&&(b=a.getAttribute("data-validation-text")?a.getAttribute("data-validation-text"):Joomla.JText._("JLIB_FORM_CONTAINS_INVALID_FIELDS"),c={error:[b]},Joomla.renderMessages(c)),e}},{key:"attachToForm",value:function attachToForm(a){var b=this,c=[],d=[].slice.call(a.querySelectorAll("input, textarea, select, button, fieldset"));d.forEach(function(d){var e=d.tagName.toLowerCase();-1<["input","textarea","select","fieldset"].indexOf(e)&&d.classList.contains("required")&&d.setAttribute("required",""),("input"===e||"button"===e)&&("submit"===d.getAttribute("type")||"image"===d.getAttribute("type"))?d.classList.contains("validate")&&d.addEventListener("click",function(){return b.isValid(a)}):"button"!==e&&("input"!==e||"button"!==d.getAttribute("type"))&&("fieldset"!==e&&(d.addEventListener("blur",function(a){var c=a.target;return b.validate(c)}),d.addEventListener("focus",function(a){var c=a.target;return b.removeMarking(c)}),d.classList.contains("validate-email")&&b.inputEmail&&d.setAttribute("type","email")),c.push(d))})}},{key:"custom",get:function get(){return this.customValidators},set:function set(a){this.customValidators=a}}]),b}(),c=function(){a.formvalidator=new b,a.removeEventListener("DOMContentLoaded",c)};a.addEventListener("DOMContentLoaded",c)})(document);