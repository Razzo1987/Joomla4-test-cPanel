function _slicedToArray(a,b){return _arrayWithHoles(a)||_iterableToArrayLimit(a,b)||_unsupportedIterableToArray(a,b)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(a,b){if(a){if("string"==typeof a)return _arrayLikeToArray(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?_arrayLikeToArray(a,b):void 0}}function _arrayLikeToArray(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}function _iterableToArrayLimit(a,b){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(a)){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}return c}}function _arrayWithHoles(a){if(Array.isArray(a))return a}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}(function(a){'use strict';var c=new RegExp(/^#([a-z0-9]{1,2})([a-z0-9]{1,2})([a-z0-9]{1,2})$/i),d=new RegExp(/^rgba?\(([0-9]+)[\D]+([0-9]+)[\D]+([0-9]+)(?:[\D]+([0-9](?:.\d+)?))?\)$/i),e=new RegExp(/^hsla?\(([0-9]+)[\D]+([0-9]+)[\D]+([0-9]+)[\D]+([0-9](?:.\d+)?)?\)$/i),f=new RegExp(/^(([0-1])|(0\\.[0-9]+)|([0-9]{1,2})|(100))$/),g=new RegExp(/^[0-9]{1,3}$/),h=function(){function a(b){var c=this;_classCallCheck(this,a),this.messageSpan=b.querySelector(".form-control-feedback"),this.mainInput=b.querySelector(".color-input"),this.input=b.querySelector("#slider-input"),this.sliders=b.querySelectorAll(".color-slider"),this.hueSlider=b.querySelector("#hue-slider"),this.saturationSlider=b.querySelector("#saturation-slider"),this.lightSlider=b.querySelector("#light-slider"),this.alphaSlider=b.querySelector("#alpha-slider"),this.color=b.dataset.color||"",this.default=b.dataset.default||"",this.format=this.input.dataset.format||"hex",this.saveFormat=this.mainInput.dataset.format||"hex",this.preview="true"===b.dataset.preview,this.setAlpha="hsla"===this.format||"rgba"===this.format,this.hue=360,this.saturation=1,this.light=1,this.alpha=1,this.defaultHsl=[this.hue,this.saturation,this.light,this.alpha],this.setInitValue(),this.setBackground(),this.preview?this.setInputPattern():this.input.classList.add("hidden"),this.mainInput.classList.add("hidden"),Array.prototype.forEach.call(this.sliders,function(a){a.addEventListener("change",function(){return c.updateValue(a)})}),this.input.addEventListener("change",function(){return c.changeInput(c.input)})}return _createClass(a,[{key:"updateValue",value:function updateValue(a){this.showError("");var b=this.getSliderValueAsHsl(a.value,a.dataset.type),c=this.hslToRgb(b),d=_slicedToArray(b,4);this.hue=d[0],this.saturation=d[1],this.light=d[2],this.alpha=d[3],this.input.style.border="2px solid ".concat(this.getRgbString(c)),this.setSliderValues(b,a.dataset.type),this.setInputValue(b),this.setBackground(a)}},{key:"changeInput",value:function changeInput(a){var b=[this.hue,this.saturation,this.light,this.alpha];if(!a.value)return this.mainInput.value="",void this.showError("");if(!this.checkValue(a.value))this.showError("JFIELD_COLOR_ERROR_WRONG_FORMAT"),this.setInputValue(this.defaultHsl);else{switch(this.showError(""),this.format){case"hue":b[0]=a.value,this.hue=a.value;break;case"saturation":b[1]=a.value,this.saturation=a.value;break;case"light":b[2]=a.value,this.light=a.value;break;case"alpha":b[3]=a.value,this.alpha=a.value;break;default:b=this.getHsl(a.value);}this.setSliderValues(b),this.setInputValue(b,!0)}}},{key:"checkValue",value:function checkValue(a,b){var h=b||this.format;return"hue"===h?360>=a&&g.test(a):"saturation"===h||"light"===h||"alpha"===h?f.test(a):"hsl"===h||"hsla"===h?e.test(a):"hex"===h?c.test(a):("rgb"===h||"rgba"===h)&&d.test(a)}},{key:"setInputPattern",value:function setInputPattern(){var a;switch(this.format){case"hue":a=g.source.slice(1,-1);break;case"saturation":case"light":case"alpha":a=f.source.slice(1,-1);break;case"hsl":case"hsla":a=e.source.slice(1,-1);break;case"rgb":a=d.source.slice(1,-1);break;case"hex":default:a=c.source.slice(1,-1);}this.input.setAttribute("pattern",a)}},{key:"setBackground",value:function setBackground(a){var b=this;Array.prototype.forEach.call(this.sliders,function(c){if(a!==c){var d=[],e=100;if(d.push(b.getSliderValueAsRgb(0,c.dataset.type)),"hue"===c.dataset.type){Math.floor(18);e=360;for(var f=0;360>=f;f+=18)d.push(b.getSliderValueAsRgb(f,c.dataset.type))}else for(var g=0;100>=g;g+=10)d.push(b.getSliderValueAsRgb(g,c.dataset.type));d.push(b.getSliderValueAsRgb(e,c.dataset.type)),d=d.map(function(a){return b.getRgbString(a)}),c.style.background="linear-gradient(90deg, ".concat(d.join(","),")"),c.style.webkitAppearance="none"}})}},{key:"setInitValue",value:function setInitValue(){var a=window.getComputedStyle(this.input).getPropertyValue(this.default);if(this.default=a||this.default,""===this.color||"undefined"==typeof this.color)return this.input.value="",void(this.mainInput.value="");var b=this.checkValue(this.color,this.saveFormat)?this.color:this.default;if(!b)return void this.showError("JFIELD_COLOR_ERROR_NO_COLOUR");var c=[];/^[0-9]+$/.test(b)?(c=this.default&&this.getHsl(this.default),"hue"===this.format&&(c[0]=b),"saturation"===this.format&&(c[1]=1<b?b/100:b),"light"===this.format&&(c[2]=1<b?b/100:b),"alpha"===this.format&&(c[3]=1<b?b/100:b)):c=this.getHsl(b);var d=c,e=_slicedToArray(d,3);this.hue=e[0],this.saturation=e[1],this.light=e[2],this.alpha=c[4]||this.alpha,this.defaultHsl=this.default?this.getHsl(this.default):c,this.setSliderValues(c),this.setInputValue(c),this.input.style.border="2px solid ".concat(this.getRgbString(this.hslToRgb(c)))}},{key:"showError",value:function showError(a){this.messageSpan.innerText=a?Joomla.Text._(a):""}},{key:"getHsl",value:function getHsl(a){var b=[];if(Array.isArray(a))b=a;else if(c.test(a))b=this.hexToHsl(a);else if(d.test(a))b=this.rgbToHsl(a);else if(e.test(a)){var g=a.match(e);b=[g[1],g[2],g[3],g[4]]}else return this.showError("JFIELD_COLOR_ERROR_CONVERT_HSL"),this.defaultHsl;var f;for(f=1;f<b.length;f+=1)b[f]=1<b[f]?b[f]/100:b[f];return b}},{key:"getSliderValueAsHsl",value:function getSliderValueAsHsl(b,c){var d=this.hue,e=this.saturation,f=this.light,g=this.alpha;switch(c){case"alpha":g=b;break;case"saturation":e=b;break;case"light":f=b;break;case"hue":default:d=b;}return 1<f&&(f/=100),1<e&&(e/=100),1<g&&(g/=100),[d,e,f,g]}},{key:"getSliderValueAsRgb",value:function getSliderValueAsRgb(a,b){return this.hslToRgb(this.getSliderValueAsHsl(a,b))}},{key:"setSliderValues",value:function setSliderValues(b,c){var d=_slicedToArray(b,4),e=d[0],f=d[1],g=d[2],h=d[3];this.hueSlider&&"hue"!==c&&(this.hueSlider.value=Math.round(e)),this.saturationSlider&&"saturation"!==c&&(this.saturationSlider.value=Math.round(100*f)),this.lightSlider&&"light"!==c&&(this.lightSlider.value=Math.round(100*g)),h&&this.alphaSlider&&"alpha"!==c&&(this.alphaSlider.value=Math.round(100*h))}},{key:"setInputValue",value:function setInputValue(a,b){var c=this,d=[this.mainInput];b||d.push(this.input),d.forEach(function(b){var d;switch(b.dataset.format){case"hsl":d=c.getHslString(a);break;case"hsla":d=c.getHslString(a,!0);break;case"rgb":d=c.getRgbString(c.hslToRgb(a));break;case"rgba":d=c.getRgbString(c.hslToRgb(a),!0);break;case"hex":d=c.rgbToHex(c.hslToRgb(a));break;case"alpha":d=Math.round(100*a[3]);break;case"saturation":d=Math.round(100*a[1]);break;case"light":d=Math.round(100*a[2]);break;case"hue":default:d=Math.round(a[0]);}b.value=d})}},{key:"getRgbString",value:function getRgbString(c,d){var e=_slicedToArray(c,4),f=e[0],h=e[1],g=e[2],b=e[3];if(d||this.setAlpha){var a="undefined"==typeof b?this.alpha:b;return"rgba(".concat(f,", ").concat(h,", ").concat(g,", ").concat(a,")")}return"rgb(".concat(f,", ").concat(h,", ").concat(g,")")}},{key:"getHslString",value:function getHslString(b,c){var d=_slicedToArray(b,4),e=d[0],f=d[1],g=d[2],i=d[3];f*=100,g*=100;var j=[e,f,g].map(function(a){return Math.round(a)}),k=_slicedToArray(j,3);return e=k[0],f=k[1],g=k[2],c||this.setAlpha?(i=i||this.alpha,"hsla(".concat(e,", ").concat(f,"%, ").concat(g,"%, ").concat(i,")")):"hsl(".concat(e,", ").concat(f,"%, ").concat(g,"%)")}},{key:"rgbToHex",value:function rgbToHex(a){var c=a[0].toString(16).toUpperCase(),d=a[1].toString(16).toUpperCase(),e=a[2].toString(16).toUpperCase();return c=1===c.length?"".concat(c).concat(c):c,d=1===d.length?"".concat(d).concat(d):d,e=1===e.length?"".concat(e).concat(e):e,"#".concat(c).concat(d).concat(e)}},{key:"rgbToHsl",value:function rgbToHsl(c){var e=c;if("string"==typeof c){var r=c.match(d);e=[r[1],r[2],r[3],r[4]]}var f=e.map(function(a){return 1<a?a/255:a}),i=_slicedToArray(f,3),j=i[0],k=i[1],g=i[2],b=Math.max(j,k,g),m=Math.min(j,k,g),n=(b+m)/2,l=b-m,o=0,p=0,q=e[3]||c[3]||this.alpha;if(b!==m)switch(p=0===b?b:1===m?m:(b-n)/Math.min(n,1-n),b){case j:o=60*(k-g)/l;break;case k:o=60*(2+(g-j)/l);break;case g:default:o=60*(4+(j-k)/l);}return o=0>o?o+360:o,q=1<q?q/100:q,[o,p,n,q]}},{key:"hexToHsl",value:function hexToHsl(a){var d=a.match(c),e=d[1],f=d[2],g=d[3],b=[parseInt(e,16),parseInt(f,16),parseInt(g,16)];return this.rgbToHsl(b)}},{key:"hslToRgb",value:function hslToRgb(d){var e=_slicedToArray(d,4),f=e[0],h=e[1],i=e[2],j=e[3],k=1,m=1,n=1,o=1<h?h/100:h,p=1<i?i/100:i,l=1<j?j/100:j;if(0>f||360<f||0>o||1<o||0>p||1<p)return this.showError("JFIELD_COLOR_ERROR_CONVERT_HSL"),this.hslToRgb(this.defaultHsl);var a=(1-Math.abs(2*p-1))*o,c=a*(1-Math.abs(f/60%2-1));if(0<=f&&60>f)k=a,m=c,n=0;else if(60<=f&&120>f)k=c,m=a,n=0;else if(120<=f&&180>f)k=0,m=a,n=c;else if(180<=f&&240>f)k=0,m=c,n=a;else if(240<=f&&300>f)k=c,m=0,n=a;else if(300<=f&&360>=f)k=a,m=0,n=c;else return this.showError("JFIELD_COLOR_ERROR_CONVERT_HUE"),this.hslToRgb(this.defaultHsl);var q=[k,m,n].map(function(b){return Math.round(255*(b+(p-a/2)))});return q.push(l),q}}]),a}();a.addEventListener("DOMContentLoaded",function(){var b=a.querySelectorAll(".color-slider-wrapper");b&&Array.prototype.forEach.call(b,function(a){new h(a)})})})(document);